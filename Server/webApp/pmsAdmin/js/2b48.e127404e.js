(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["2b48"],{"2b48":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("d2-container",[a("template",{slot:"header"},[a("div",{staticClass:"layout_header_plus",on:{click:e.add}},[a("i",{staticClass:"fa fa-plus",attrs:{"aria-hidden":"true"}}),a("span",[e._v("新增")])])]),a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0}},[a("el-form-item",{attrs:{label:"商品分类"}},[a("el-select",{model:{value:e.searchForm.categoryId,callback:function(t){e.$set(e.searchForm,"categoryId",t)},expression:"searchForm.categoryId"}},[a("el-option",{attrs:{label:"全部",value:"0"}}),e._l(e.categoryList,function(e){return a("el-option",{attrs:{label:e.name,value:e.id}})})],2)],1),a("el-form-item",{attrs:{label:"商品名称"}},[a("el-input",{attrs:{placeholder:"商品名称"},model:{value:e.searchForm.name,callback:function(t){e.$set(e.searchForm,"name",t)},expression:"searchForm.name"}})],1),a("el-form-item",{attrs:{label:"状态"}},[a("el-select",{model:{value:e.searchForm.status,callback:function(t){e.$set(e.searchForm,"status",t)},expression:"searchForm.status"}},[a("el-option",{attrs:{label:"全部",value:"0"}}),a("el-option",{attrs:{label:"已上架",value:"1"}}),a("el-option",{attrs:{label:"已下架",value:"-1"}})],1)],1),a("el-form-item",{attrs:{label:""}},[a("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.search}},[e._v("查询")])],1)],1),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.dataList,size:"small",border:""}},[a("el-table-column",{attrs:{prop:"name",label:"商品名称"}}),a("el-table-column",{attrs:{prop:"categoryName",label:"商品类型"}}),a("el-table-column",{attrs:{prop:"imgUrl",label:"商品图片",width:"100px"},scopedSlots:e._u([{key:"default",fn:function(e){return[a("img",{staticStyle:{width:"100%",height:"80px"},attrs:{src:e.row.imgUrl}})]}}])}),a("el-table-column",{attrs:{prop:"marketPrice",label:"市场价"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{staticStyle:{color:"green"}},[e._v("￥"+e._s(t.row.marketPrice))])]}}])}),a("el-table-column",{attrs:{prop:"salePrice",label:"销售价"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{staticStyle:{color:"red"}},[e._v("￥"+e._s(t.row.salePrice))])]}}])}),a("el-table-column",{attrs:{prop:"totalStock",label:"库存详情"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{staticStyle:{color:"red"}},[e._v(e._s(t.row.saleStock))]),e._v("/"+e._s(t.row.totalStock)+"\n      ")]}}])}),a("el-table-column",{attrs:{prop:"status",label:"状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.status>0?a("div",[a("el-tag",{attrs:{type:"success",size:"mini"}},[e._v("已上架")]),a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){e.changeStatus(t.row)}}},[e._v("下架")])],1):a("div",[a("el-tag",{attrs:{type:"danger",size:"mini"}},[e._v("已下架")]),a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){e.changeStatus(t.row)}}},[e._v("上架")])],1)]}}])}),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){e.change(t.row)}}},[e._v("修改")])]}}])})],1),a("el-pagination",{attrs:{"current-page":e.currentPage,"page-sizes":[5,10,15,20],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.totalCount},on:{"size-change":e.pageSizeChange,"current-change":e.pageChange}}),a("el-dialog",{attrs:{title:"新增商品",visible:e.addDialog},on:{"update:visible":function(t){e.addDialog=t}}},[a("el-form",{ref:"addForm",staticClass:"demo-form-inline",attrs:{model:e.addForm,"label-width":"80px"}},[a("el-form-item",{attrs:{label:"商品名称",prop:"name",rules:[{required:!0,message:"商品名称不为空"}]}},[a("el-input",{staticStyle:{width:"85%"},attrs:{placeholder:"商品名称"},model:{value:e.addForm.name,callback:function(t){e.$set(e.addForm,"name","string"===typeof t?t.trim():t)},expression:"addForm.name"}})],1),a("el-form-item",{attrs:{label:"商品分类"}},[a("el-select",{staticStyle:{width:"85%"},attrs:{placeholder:"分类标识"},model:{value:e.addForm.categoryId,callback:function(t){e.$set(e.addForm,"categoryId","string"===typeof t?t.trim():t)},expression:"addForm.categoryId"}},e._l(e.categoryList,function(e){return a("el-option",{attrs:{label:e.name,value:e.id}})}))],1),a("el-form-item",{attrs:{label:"门市价",prop:"marketPrice",rules:[{required:!0,message:"门市价不能为空"},{required:!0,validator:e.checkPrice,trigger:"blur"}]}},[a("el-input",{staticStyle:{width:"85%"},attrs:{placeholder:"门市价"},model:{value:e.addForm.marketPrice,callback:function(t){e.$set(e.addForm,"marketPrice","string"===typeof t?t.trim():t)},expression:"addForm.marketPrice"}})],1),a("el-form-item",{attrs:{label:"销售价",prop:"salePrice",rules:[{required:!0,message:"销售价不能为空"},{required:!0,validator:e.checkPrice,trigger:"blur"}]}},[a("el-input",{staticStyle:{width:"85%"},attrs:{placeholder:"销售价"},model:{value:e.addForm.salePrice,callback:function(t){e.$set(e.addForm,"salePrice","string"===typeof t?t.trim():t)},expression:"addForm.salePrice"}})],1),a("el-form-item",{attrs:{label:"商品库存",prop:"totalStock",rules:[{required:!0,message:"库存不能为空"},{required:!0,validator:e.checkStock,trigger:"blur"}]}},[a("el-input",{staticStyle:{width:"85%"},attrs:{placeholder:"商品库存"},model:{value:e.addForm.totalStock,callback:function(t){e.$set(e.addForm,"totalStock","string"===typeof t?t.trim():t)},expression:"addForm.totalStock"}})],1),a("el-form-item",{attrs:{label:"商品图片",prop:"imgUrl",rules:[{required:!0,validator:e.checkImg,trigger:"change"}]}},[a("el-upload",{staticClass:"upload-demo",attrs:{action:"/api/v1/uploadImg","on-success":e.handleSuccess,"on-remove":e.handleRemove,"file-list":e.addForm.imgList,"list-type":"picture"}},[a("el-button",{attrs:{size:"small",type:"primary"}},[e._v("点击上传")])],1)],1),a("el-row",{staticClass:"row-bg",attrs:{type:"flex",justify:"center"}},[a("el-col",{staticStyle:{"text-align":"right"}},[a("el-button",{on:{click:function(t){e.addDialog=!1}}},[e._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.saveAdd}},[e._v("保存")])],1)],1)],1)],1),a("el-dialog",{attrs:{title:"修改商品信息",visible:e.changeDialog},on:{"update:visible":function(t){e.changeDialog=t}}},[a("el-form",{ref:"changeForm",staticClass:"demo-form-inline",attrs:{model:e.changeForm,"label-width":"80px"}},[a("el-form-item",{attrs:{label:"商品名称",prop:"name",rules:[{required:!0,message:"商品名称不为空"}]}},[a("el-input",{staticStyle:{width:"85%"},attrs:{placeholder:"商品名称"},model:{value:e.changeForm.name,callback:function(t){e.$set(e.changeForm,"name","string"===typeof t?t.trim():t)},expression:"changeForm.name"}})],1),a("el-form-item",{attrs:{label:"商品分类"}},[a("el-select",{staticStyle:{width:"85%"},attrs:{placeholder:"分类标识"},model:{value:e.changeForm.categoryId,callback:function(t){e.$set(e.changeForm,"categoryId","string"===typeof t?t.trim():t)},expression:"changeForm.categoryId"}},e._l(e.categoryList,function(e){return a("el-option",{attrs:{label:e.name,value:e.id}})}))],1),a("el-form-item",{attrs:{label:"门市价",prop:"marketPrice",rules:[{required:!0,message:"门市价不能为空"},{required:!0,validator:e.checkPrice,trigger:"blur"}]}},[a("el-input",{staticStyle:{width:"85%"},attrs:{placeholder:"门市价"},model:{value:e.changeForm.marketPrice,callback:function(t){e.$set(e.changeForm,"marketPrice","string"===typeof t?t.trim():t)},expression:"changeForm.marketPrice"}})],1),a("el-form-item",{attrs:{label:"销售价",prop:"salePrice",rules:[{required:!0,message:"销售价不能为空"},{required:!0,validator:e.checkPrice,trigger:"blur"}]}},[a("el-input",{staticStyle:{width:"85%"},attrs:{placeholder:"销售价"},model:{value:e.changeForm.salePrice,callback:function(t){e.$set(e.changeForm,"salePrice","string"===typeof t?t.trim():t)},expression:"changeForm.salePrice"}})],1),a("el-form-item",{attrs:{label:"已售数量"}},[a("el-input",{staticStyle:{width:"85%"},attrs:{disabled:"",placeholder:"商品库存"},model:{value:e.changeForm.saleStock,callback:function(t){e.$set(e.changeForm,"saleStock","string"===typeof t?t.trim():t)},expression:"changeForm.saleStock"}})],1),a("el-form-item",{attrs:{label:"商品库存",prop:"totalStock",rules:[{required:!0,message:"库存不能为空"},{required:!0,validator:e.checkStock,trigger:"blur"}]}},[a("el-input",{staticStyle:{width:"85%"},attrs:{placeholder:"商品库存"},model:{value:e.changeForm.totalStock,callback:function(t){e.$set(e.changeForm,"totalStock","string"===typeof t?t.trim():t)},expression:"changeForm.totalStock"}})],1),a("el-form-item",{attrs:{label:"商品图片",prop:"imgUrl",rules:[{required:!0,validator:e.checkImg,trigger:"change"}]}},[a("el-upload",{staticClass:"upload-demo",attrs:{action:"/api/v1/uploadImg","on-success":e.changeHandleSuccess,"on-remove":e.changeHandleRemove,"file-list":e.changeForm.imgList,"list-type":"picture"}},[a("el-button",{attrs:{size:"small",type:"primary"}},[e._v("点击上传")])],1)],1),a("el-row",{staticClass:"row-bg",attrs:{type:"flex",justify:"center"}},[a("el-col",{staticStyle:{"text-align":"right"}},[a("el-button",{on:{click:function(t){e.changeDialog=!1}}},[e._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.saveChange}},[e._v("保存")])],1)],1)],1)],1)],2)},l=[],o=a("c93e"),i=(a("c5f6"),a("7f7f"),a("96cf"),a("3040")),s={name:"goodsSearch",created:function(){this.getCategory()},mounted:function(){this.getData()},data:function(){return{searchForm:{categoryId:"0",name:"",code:"",status:"0"},pageSize:5,currentPage:1,totalCount:0,categoryList:[],dataList:[],addForm:{name:"",categoryId:1,marketPrice:"",salePrice:"",imgUrl:"",saleStock:0,totalStock:"",imgList:[]},addDialog:!1,changeForm:{id:"",name:"",categoryId:1,marketPrice:"",salePrice:"",imgUrl:"",saleStock:"",totalStock:"",imgList:[]},changeDialog:!1}},methods:{checkPrice:function(e,t,a){var r=/^\d+(?=\.{0,1}\d+$|$)/;r.test(t)?a():a("请输入正确的价格！")},checkImg:function(e,t,a){""==t?a("请上传该商品图片"):a()},checkStock:function(e,t,a){var r=/(^[1-9]\d*$)/;r.test(t)?a():a("请输入正确的库存！")},getCategory:function(){var e=Object(i["a"])(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$http.getCategoryList({name:"",code:"",status:1});case 2:t=e.sent,this.categoryList=t.data.data,this.addForm.categoryId=t.data.data[0].id;case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),search:function(){1!=this.currentPage?this.currentPage=1:this.getData()},getData:function(){var e=Object(i["a"])(regeneratorRuntime.mark(function e(){var t,a,r,l,o,i;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=this.searchForm,a=t.categoryId,r=t.name,l=t.status,o={categoryId:a,name:r,status:l,limit:this.pageSize,page:this.currentPage},e.next=4,this.$http.getGoodsList(o);case 4:i=e.sent,console.log(i),this.dataList=i.data.data,this.totalCount=i.data.totalCount;case 8:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),add:function(){this.addDialog=!0,this.$refs.addForm.resetFields()},saveAdd:function(){var e=this;this.$refs.addForm.validate(function(t){if(!t)return!1;var a=e.addForm,r=a.name,l=a.categoryId,o=a.imgUrl,i=a.marketPrice,s=a.salePrice,c=a.totalStock,n={name:r,categoryId:l,imgUrl:o,marketPrice:i,salePrice:s,totalStock:c};e.$http.postAddGoods(n),e.getData(),e.addDialog=!1})},handleRemove:function(e,t){this.addForm.imgList=t,this.addForm.imgUrl=""},handleSuccess:function(e,t,a){this.addForm.imgList.push({url:e.data.pictureUrl}),this.addForm.imgUrl=e.data.pictureUrl},changeHandleRemove:function(e,t){this.changeForm.imgList=t,this.changeForm.imgUrl=""},changeHandleSuccess:function(e,t,a){this.changeForm.imgList.push({url:e.data.pictureUrl}),this.changeForm.imgUrl=e.data.pictureUrl},changeStatus:function(e){var t=this,a=e.status>0?"下架":"上架";this.$confirm("您将".concat(a,"商品《").concat(e.name,"》, 是否继续?"),"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(i["a"])(regeneratorRuntime.mark(function a(){return regeneratorRuntime.wrap(function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,t.$http.postUpdateGoodsStatus({id:e.id,status:1==e.status?-1:1});case 2:t.getData();case 3:case"end":return a.stop()}},a,this)}))).catch(function(){})},change:function(e){this.changeDialog=!0;var t=[{url:e.imgUrl}],a=Number(e.categoryId);this.changeForm=Object(o["a"])({},e,{imgList:t,categoryId:a})},saveChange:function(){var e=this;this.$refs.changeForm.validate(function(t){if(!t)return!1;var a=e.changeForm;a.name,a.categoryId,a.imgUrl,a.marketPrice,a.salePrice,a.totalStock,a.id;e.$http.postChangeGoods(e.changeForm),e.getData(),e.changeDialog=!1})},pageSizeChange:function(e,t){this.pageSize=e,this.getData()},pageChange:function(e){this.currentPage=e,this.getData()}}},c=s,n=a("2877"),m=Object(n["a"])(c,r,l,!1,null,null,null);m.options.__file="goodsSearch.vue";t["default"]=m.exports}}]);
//# sourceMappingURL=2b48.e127404e.js.map